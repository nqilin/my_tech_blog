<!-- Blog Home Page - Optimized (Search + Category Filter + Card Layout) -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ data.title }} - Home</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- Blog Header -->
    <header>
        <h1>{{ data.title }}</h1>
        <p>{{ data.subtitle }}</p>
    </header>

    <!-- 核心：全局统一导航 + 搜索框 + 动态分类（Jinja2渲染） -->
    <div class="nav-search-container">
        <div class="nav-links">
            <a href="{{ url_for('index') }}" class="{% if request.path == '/' %}active{% endif %}">Home</a>
            <a href="{{ url_for('about') }}" class="{% if request.path == '/about' %}active{% endif %}">About Me</a>
            <!-- 动态渲染所有分类（后续后端传参categories，预留语法） -->
            {% if categories %}
                <div class="dropdown">
                    <button class="dropdown-btn">Categories ▾</button>
                    <div class="dropdown-menu">
                        {% for category in categories %}
                            <a href="{{ url_for('category_posts', category_name=category) }}" 
                            class="{% if request.path == url_for('category_posts', category_name=category) %}active{% endif %}">
                                {{ category }}
                            </a>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}
        </div>
        <!-- 关键字搜索框 - GET请求，预留query参数，action指向首页 -->
        <form class="search-form" action="/" method="GET">
            <input type="text" name="query" placeholder="Search articles (title/content)..." value="{{ request.args.get('query', '') }}">
            <button type="submit">Search</button>
        </form>
    </div>

    <!-- Main Content -->
    <main>
        <h2 class="category-title">
            {% if request.args.get('query') %}
                Search Results for: "{{ request.args.get('query') }}"
            {% else %}
                {{ data.latest_article_tip }}
            {% endif %}
        </h2>

        <!-- 文章列表：卡片式网格布局 + 无结果提示 -->
        {% if posts %}
            <div class="articles-grid">
                {% for post in posts %}
                    <div class="article-card">
                        <h3><a href="/article/{{ post.id }}">{{ post.title }}</a></h3>
                        <div class="article-meta">
                            <span class="category-tag">{{ post.category }}</span>
                            <span>Published: {{ post.date }}</span>
                        </div>
                        <p class="article-excerpt">{{ post.content|striptags|truncate(150) }}...</p>
                        <a href="/article/{{ post.id }}" class="read-more">Read More</a>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <!-- 无文章/无搜索结果提示 -->
            <div class="no-results">
                <h3>No Articles Found</h3>
                {% if request.args.get('query') %}
                    <p>There are no articles matching your search keyword. Please try another one.</p>
                {% else %}
                    <p>There are no articles published yet. Stay tuned for updates!</p>
                {% endif %}
                <a href="/">← Back to Home</a>
            </div>
        {% endif %}
    </main>

    <!-- Footer -->
    <footer>
        <p>© 2026 {{ data.title }} | All Rights Reserved</p>
    </footer>
</body>
</html>